rule all:
    input:
        'results/metrics.tsv',
        'results/report.md',
        'results/manifest.json'

rule prepare:
    output:
        touch('results/.prepared')
    shell:
        'mkdir -p results && touch results/.prepared'

TOOL_SOURCES = expand("data/tools/{name}.tsv", name=["SpliceAI","CADD","REVEL"])  # adjust names you have

rule tool_to_prediction:
    input:
        variants="data/simulated_variants.tsv",
        tool_src="data/tools/{name}.tsv"
    output:
        "results/predictions/{name}.tsv"
    script:
        "workflow/scripts/join_one_tool.py"   # reuse join logic (parametrize by {wildcards.name})

rule benchmark:
    input:
        variants='data/simulated_variants.tsv',
        truth='data/truth_labels.tsv',
        prepared='results/.prepared',
        code=["src/main.py", "src/utils.py"]
    output:
        metrics='results/metrics.tsv',
        report='results/report.md',
        manifest='results/manifest.json'
    shell:
        'python -m src.main'
